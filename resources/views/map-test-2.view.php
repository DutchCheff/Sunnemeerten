<?php require_once '../resources/views/header.view.php'; ?>
<div class="mt-16">
<a href="?page=map-test" class="bg-accent2">Map test 1</a>
</div>
<div id="map" style="height: 500px;"></div>

<script>
  // Initialize map centered on a general location
  const map = L.map('map').setView([52.3702, 4.8952], 13); // Example: Amsterdam

  // Load map tiles
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: 'Â© OpenStreetMap contributors'
  }).addTo(map);

  // Define the route (sample coordinates)
  const routeCoords = [
    [53.22103610524957, 6.54639794252773],
    [53.221302158417124, 6.547390866606573],
    [53.2217370893975, 6.5473526333791705],
    [53.22232080561372, 6.55044952479881],
    [53.22257260230972, 6.550296591889199],
    [53.22355613005343, 6.553554151445711],
    [53.223392121668354, 6.553781663366694],
    [53.224042535024566, 6.554927539370535],
    [53.224586944795256, 6.554870705335616],
    [53.22498504005931, 6.5552173929486255],
    [53.22495782000474, 6.555444729060602],
    [53.22525501461164, 6.55558642689514],
    [53.22560418843458, 6.556115903020832],
    [53.226096989194744, 6.557030076646784],
    [53.22619361952967, 6.558016107795127],
    [53.22636469683284, 6.558343305674126],
    [53.22646487593917, 6.559359744149878],
    [53.226711612378395, 6.560103479539545],
    [53.226943506222554, 6.560007413707995],
    [53.22713829608115, 6.560472248376784],
    [53.22800278134792, 6.560066292768336],
    [53.23191510761818, 6.5628798748686],
    [53.230262072579585, 6.566499598940919],
    [53.2297983195794, 6.567615202146014],
    [53.231881547979015, 6.572225915764361],
    [53.230151166729264, 6.574449013068241],
    [53.23015487674262, 6.574597760162254],
    [53.22983581441876, 6.575031605853123],
    [53.2297467733459, 6.574966528999493],
    [53.22412358052043, 6.582173350267673],
    [53.222611533918354, 6.583657367926877],
    [53.22218109439856, 6.583951763209079],
    [53.220832169510054, 6.583136595740282],
    [53.220568700410944, 6.583353518585717],
    [53.21981340851583, 6.581295497041016],
    [53.21856095831864, 6.578611851612096],
    [53.218141134466755, 6.577218349995699],
    [53.21701160217113, 6.574381906307654],
    [53.21641546626498, 6.572466302091091],
    [53.21543676880095, 6.569923057312781],
    [53.21480398944164, 6.567794114596364],
    [53.214467623915446, 6.5665249966643495],
    [53.21442123173514, 6.565412492370718],
    [53.21448989214555, 6.563534560374866],
    [53.21466952423516, 6.562808260562031],
    [53.21480127713082, 6.562179184310269],
    [53.21494416361593, 6.562055228398591],
    [53.21523735777878, 6.561175141466888],
    [53.215685430039755, 6.5596068907427405],
    [53.216607669946946, 6.559603791861298],
    [53.216635503840166, 6.559179242863804],
    [53.21724558115214, 6.559189279992777],
    [53.21773173664657, 6.5589940494318855],
    [53.218123254808546, 6.558473434602842],
    [53.21901630341566, 6.55717497572286],
    [53.2190560993445, 6.556795180381903],
    [53.21899072029902, 6.555969125515319],
    [53.219382993086164, 6.555812460008057],
    [53.21936593782991, 6.555029132177523],
    [53.21978378982781, 6.5527598550152995],
    [53.21973245080323, 6.550450093317911],
    [53.21939703211338, 6.548370713826166],
    [53.22034358828365, 6.54782001064417],
    [53.220872286227916, 6.547535164155145],
    [53.22066478727718, 6.5464907269675106]
  ];

  // Draw route as a polyline
  const routeLine = L.polyline(routeCoords, { color: 'blue' }).addTo(map);
  map.fitBounds(routeLine.getBounds());

  // Current parade location (can be updated dynamically)
  const currentLocation = [53.231881547979015, 6.572225915764361];
  const marker = L.marker(currentLocation).addTo(map)
    .bindPopup('Parade is here now.')
    .openPopup();

    // setInterval(async () => {
    //     const response = await fetch('/api/parade-location');
    //     const { lat, lng } = await response.json();
    //     marker.setLatLng([lat, lng]);
    // }, 5000); 

    // Uncomment the above lines to fetch parade location dynamically
</script>

<?php require_once '../resources/views/footer.view.php'; ?>